<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ikeflix</title>
<link rel="shortcut icon" href="Logo.png">
<style>

/* --------------------------- */
/*         RESET              */
/* --------------------------- */

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Segoe UI", sans-serif;
}

body {
  background: #000;
  color: #fff;
  overflow-x: hidden;
}

/* --------------------------- */
/*      ANIMACIONES GLOBALES  */
/* --------------------------- */

.fade-in {
  animation: fadein 0.5s ease forwards;
  opacity: 0;
}

@keyframes fadein {
  to { opacity: 1; }
}

.slide-up {
  animation: slideup 0.5s ease forwards;
  opacity: 0;
  transform: translateY(20px);
}

@keyframes slideup {
  to { opacity: 1; transform: translateY(0); }
}

/* --------------------------- */
/*       PANTALLA LOGIN       */
/* --------------------------- */

#auth-screen {
  width: 100%;
  height: 100vh;
  display: flex;
  position: fixed;
  top: 0;
  left: 0;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, #000 40%, #111);
  z-index: 100;
}

.auth-box {
  width: 380px;
  padding: 40px;
  background: rgba(0,0,0,0.75);
  border-radius: 15px;
  box-shadow: 0 0 40px rgba(255,0,0,0.15);
  animation: fadein 0.5s ease forwards;
}

.auth-box img {
  width: 150px;
  margin: 0 auto 20px auto;
  display: block;
}

.auth-box input {
  width: 100%;
  margin: 8px 0;
  padding: 12px;
  border-radius: 6px;
  border: none;
  outline: none;
  background: #222;
  color: white;
  font-size: 15px;
}

.auth-box button {
  width: 100%;
  margin-top: 12px;
  padding: 12px;
  background: red;
  border: none;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
  transition: 0.2s;
}

.auth-box button:hover {
  background: #c40000;
}

/* Switch login / register */
.switch {
  margin-top: 10px;
  text-align: center;
  font-size: 14px;
  opacity: 0.7;
  cursor: pointer;
}

/* --------------------------- */
/*       SELECCION PERFIL     */
/* --------------------------- */

#profile-screen {
  display: none;
  position: fixed;
  width: 100%;
  height: 100vh;
  background: #000;
  top: 0;
  left: 0;
  text-align: center;
  padding-top: 130px;
  z-index: 90;
}

.profile-container {
  display: flex;
  justify-content: center;
  gap: 40px;
  margin-top: 40px;
}

.profile {
  cursor: pointer;
  transition: 0.3s;
}

.profile img {
  width: 110px;
  height: 110px;
  border-radius: 10px;
  object-fit: cover;
  border: 3px solid #fff;
}

.profile:hover {
  transform: scale(1.05);
}

/* --------------------------- */
/*        TOPBAR NAV          */
/* --------------------------- */

.topbar {
  width: 100%;
  position: fixed;
  top: 0;
  left: 0;
  padding: 15px 30px;
  background: linear-gradient(180deg, rgba(0,0,0,0.9), transparent);
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 50;
}

.topbar-left {
  display: flex;
  align-items: center;
  gap: 20px;
}

.topbar-left img {
  height: 50px;
}

.topbar-right {
  display: flex;
  align-items: center;
  gap: 18px;
}

.topbar-right button {
  background: none;
  border: none;
  color: white;
  font-size: 17px;
  cursor: pointer;
  transition: 0.3s;
}

.topbar-right button:hover {
  opacity: 0.7;
}

#profile-icon {
  width: 45px;
  height: 45px;
  border-radius: 8px;
  object-fit: cover;
}

/* --------------------------- */
/*         HOME UI            */
/* --------------------------- */

#home-screen {
  padding-top: 110px;
}

.big-banner {
  width: 100%;
  height: 50vh;
  background-size: cover;
  background-position: center;
  margin-bottom: 20px;
}

.section-title {
  margin: 15px 30px;
  font-size: 23px;
}

.movies-row {
  display: flex;
  overflow-x: auto;
  padding-left: 30px;
  gap: 18px;
}

.movie-item img {
  width: 230px;
  height: 130px;
  border-radius: 8px;
  object-fit: cover;
  cursor: pointer;
  transition: 0.3s;
}

.movie-item img:hover {
  transform: scale(1.05);
}

/* --------------------------- */
/*       SETTINGS PANEL       */
/* --------------------------- */

#settings-panel {
  display: none;
  position: fixed;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.85);
  top: 0;
  left: 0;
  z-index: 200;
  padding-top: 80px;
  text-align: center;
}

#settings-panel img {
  width: 160px;
  height: 160px;
  border-radius: 15px;
  border: 3px solid #fff;
  object-fit: cover;
}

.settings-btn {
  margin-top: 25px;
  padding: 15px 40px;
  background: red;
  border: none;
  font-size: 18px;
  border-radius: 8px;
  cursor: pointer;
}

</style>
</head>
<body>

<!-- ----------------------------- -->
<!--        PANTALLA LOGIN        -->
<!-- ----------------------------- -->

<div id="auth-screen">
  <div class="auth-box fade-in">

    <img src="Logo.png">

    <h2 id="auth-title" style="text-align:center;margin-bottom:12px;">Iniciar sesión</h2>

    <input id="auth-user" placeholder="Usuario">
    <input id="auth-pass" placeholder="Contraseña" type="password">

    <button onclick="authAction()">Continuar</button>

    <div class="switch" onclick="switchAuth()">¿No tienes cuenta? Regístrate</div>

  </div>
</div>

<!-- ----------------------------- -->
<!--       SELECCION PERFIL       -->
<!-- ----------------------------- -->

<div id="profile-screen" class="fade-in">

  <h1>¿Quién está viendo Ikeflix?</h1>

  <div class="profile-container" id="profile-container"></div>

</div>

<!-- ----------------------------- -->
<!--             HOME             -->
<!-- ----------------------------- -->

<div class="topbar">
  <div class="topbar-left">
    <img src="Logo.png">
    <button onclick="goHome()">Inicio</button>
  </div>

  <div class="topbar-right">
    <button onclick="openSettings()">Ajustes</button>
    <img id="profile-icon" src="default.png">
  </div>
</div>

<div id="home-screen"></div>

<!-- ----------------------------- -->
<!--           SETTINGS           -->
<!-- ----------------------------- -->

<div id="settings-panel">

  <h1>Ajustes</h1>

  <h3>Icono de perfil</h3>
  <img id="settings-icon" src="default.png"><br><br>

  <input type="file" id="icon-upload" accept="image/*"><br><br>

  <button class="settings-btn" onclick="logout()">Cerrar sesión</button><br><br>
  <button class="settings-btn" onclick="closeSettings()" style="background:#444;">Cerrar</button>

</div>

<script src="movies.js"></script>

<script>

/* ------------------------------ */
/*  LOGIN / REGISTER LOGIC        */
/* ------------------------------ */

let mode = "login";

function switchAuth() {
  mode = (mode === "login") ? "register" : "login";
  document.getElementById("auth-title").innerText =
      mode === "login" ? "Iniciar sesión" : "Registro";
  document.querySelector(".switch").innerText =
      mode === "login" ? "¿No tienes cuenta? Regístrate" : "¿Ya tienes cuenta? Inicia sesión";
}

function authAction() {
  const user = document.getElementById("auth-user").value;
  const pass = document.getElementById("auth-pass").value;

  if (mode === "register") {
    localStorage.setItem("ikeflix_user", user);
    localStorage.setItem("ikeflix_pass", pass);
    createDefaultProfiles();
    alert("Cuenta creada.");
    switchAuth();
  } else {
    if (user === localStorage.getItem("ikeflix_user") &&
        pass === localStorage.getItem("ikeflix_pass")) {

      document.getElementById("auth-screen").style.display = "none";
      loadProfiles();
    } else {
      alert("Datos incorrectos.");
    }
  }
}

/* ------------------------------ */
/*  PERFILES                      */
/* ------------------------------ */

function createDefaultProfiles() {
  const profiles = [
    { name:"Tú", icon:"default.png" }
  ];
  localStorage.setItem("ikeflix_profiles", JSON.stringify(profiles));
}

function loadProfiles() {
  document.getElementById("profile-screen").style.display = "block";

  const list = document.getElementById("profile-container");
  list.innerHTML = "";

  const profiles = JSON.parse(localStorage.getItem("ikeflix_profiles"));

  profiles.forEach((p,i)=>{
    list.innerHTML += `
      <div class="profile fade-in" onclick="selectProfile(${i})">
        <img src="${p.icon}">
        <p>${p.name}</p>
      </div>
    `;
  });
}

function selectProfile(index){
  const profiles = JSON.parse(localStorage.getItem("ikeflix_profiles"));
  const p = profiles[index];

  localStorage.setItem("ikeflix_active_profile", index);

  document.getElementById("profile-icon").src = p.icon;
  document.getElementById("settings-icon").src = p.icon;

  document.getElementById("profile-screen").style.display = "none";

  loadHome();
}

/* ------------------------------ */
/*  SETTINGS                      */
/* ------------------------------ */

function openSettings(){
  const index = localStorage.getItem("ikeflix_active_profile");
  const profiles = JSON.parse(localStorage.getItem("ikeflix_profiles"));

  document.getElementById("settings-icon").src = profiles[index].icon;

  document.getElementById("settings-panel").style.display="block";
}

function closeSettings(){
  document.getElementById("settings-panel").style.display="none";
}

document.getElementById("icon-upload").addEventListener("change", function(){
  const file = this.files[0];
  const reader = new FileReader();

  reader.onload = function(e){
    const index = localStorage.getItem("ikeflix_active_profile");
    const profiles = JSON.parse(localStorage.getItem("ikeflix_profiles"));
    profiles[index].icon = e.target.result;

    localStorage.setItem("ikeflix_profiles", JSON.stringify(profiles));

    document.getElementById("profile-icon").src = e.target.result;
    document.getElementById("settings-icon").src = e.target.result;
  };

  reader.readAsDataURL(file);
});

/* ------------------------------ */
/*  HOME UI                       */
/* ------------------------------ */

function goHome(){
  loadHome();
}

function loadHome(){
  loadMovies(); // from movies.js
}

function logout(){
  localStorage.removeItem("ikeflix_active_profile");
  document.getElementById("settings-panel").style.display="none";
  location.reload();
}

</script>

</body>
</html>
